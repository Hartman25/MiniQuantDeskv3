# ============================================================================
# MiniQuantDesk v2 Configuration
# ============================================================================
# Single source of truth for all trading parameters
# Validated on load, fails fast on errors
#
# IMPORTANT: Parameter names must match strategy constructor exactly

# ============================================================================
# RISK MANAGEMENT - MICRO ACCOUNT ($1,000-1,500)
# ============================================================================
risk:
  # Account setup
  initial_account_value: 1000.0            # Your starting capital
  
  # Position limits (CONSERVATIVE for micro account)
  max_open_positions: 1                    # Only 1 position at a time
  max_position_size_pct: 5.0               # Max 5% of account per position
  
  # Loss limits (TIGHT for micro account)
  daily_loss_limit_usd: 10.0               # Halt if lose $10/day
  weekly_loss_limit_usd: 25.0              # Halt if lose $25/week
  
  # Per-trade risk (CONSERVATIVE)
  risk_per_trade_pct: 0.2                  # 0.2% per trade (~$2 on $1000)
  
  # Circuit breaker
  circuit_breaker_enabled: true
  circuit_breaker_loss_pct: 2.0            # Trigger at 2% account loss ($20 on $1000)
  halt_duration_minutes: 60                # Halt for 1 hour

# ============================================================================
# BROKER CONNECTION
# ============================================================================
broker:
  name: alpaca
  api_key: YOUR_API_KEY                    # Override with .env.local
  api_secret: YOUR_API_SECRET              # Override with .env.local
  base_url: https://paper-api.alpaca.markets
  paper_trading: true                      # CRITICAL: Set false for live

# ============================================================================
# MARKET DATA
# ============================================================================
data:
  primary_provider: alpaca
  fallback_providers:
    - polygon
  max_staleness_seconds: 65                # TIGHTENED: 65s for 1Min bars (was 90s)
  cache_enabled: true
  cache_dir: data/cache

# ============================================================================
# STRATEGIES - MICRO ACCOUNT (for $1,000-1,500 accounts)
# ============================================================================
# Using VWAPMicroMeanReversion - optimized for small accounts with PDT limits
strategies:
  - name: VWAPMicroMeanReversion           # Micro account strategy (ChatGPT version)
    enabled: true
    symbols:
      - SPY                                 # Only trades SPY (liquid, predictable)
    timeframe: 1Min
    lookback_bars: 120
    parameters:
      # VWAP calculation
      vwap_min_bars: 20                    # Minimum bars before trading
      
      # Entry/Exit thresholds (TIGHT for micro account)
      entry_deviation_pct: 0.003           # 0.3% deviation from VWAP to enter
      stop_loss_pct: 0.003                 # 0.3% stop loss (tight!)
      take_profit_pct: 0.0015              # 0.15% take profit target
      
      # Position sizing (FIXED DOLLAR RISK)
      risk_dollars_per_trade: 1.50         # Risk exactly $1.50 per trade
      
      # Trade limits (PDT-SAFE)
      max_trades_per_day: 1                # Only 1 trade/day max
      daily_loss_limit_usd: 2.50           # Stop if lose $2.50 today
      
      # Time gates (US EASTERN TIME)
      trade_start_time: "10:00"            # Start at 10am ET (after open volatility)
      trade_end_time: "11:30"              # Stop at 11:30am ET (morning window only)
      flat_time: "15:55"                   # Force exit at 15:55 ET (before close)

# ============================================================================
# SESSION - PDT-SAFE for accounts under $25k
# ============================================================================
session:
  cycle_interval_seconds: 60               # Check every 60 seconds
  max_daily_trades: 1                      # PDT protection (matches micro strategy)
  trading_hours_only: false  # TESTING: allow extended hours
  startup_recovery_enabled: true           # Recover positions on restart

# ============================================================================
# LOGGING
# ============================================================================
logging:
  log_dir: logs
  log_level: INFO                          # DEBUG|INFO|WARNING|ERROR|CRITICAL
  console_level: INFO
  json_logs: true                          # JSON format for ML/AI
  max_bytes: 10000000                      # 10MB per file
  backup_count: 5                          # Keep 5 backups

# ============================================================================
# PATHS
# ============================================================================
position_db_path: data/positions/positions.db
transaction_log_path: data/transactions/transactions.log
limit_tracker_path: data/limits/limits.json
